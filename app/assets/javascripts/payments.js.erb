$(function () {
  	var bill_amt = 200;

    $('#customButton').click(function(){
        var token = function(res){
      	    $("#stripe_token").val(res.id);
      	    $("form").submit();
            //console.log('Got token ID:', res.id);

        };
        <% raise "Key not set!" if ENV['B4L_STRIPE_PUBLISHABLE_KEY'].blank? %>
        StripeCheckout.open({
            key:         "<%= ENV['B4L_STRIPE_PUBLISHABLE_KEY'] %>",
            amount:      bill_amt,
            name:        '1 Bracket to Support SIDS Research',
            image: 		 "/assets/logo-black.png",
            panelLabel:  'Donate',
            token:       token
        });

        return false;
    });

	$('select.opts').on('change', function() {
	    var total = 2 + parseInt(this.value,10);
	    $('#amt_shown').text("Total: $"+total+".00");
	    bill_amt = total * 100;
	    $("#payment_amt").val(bill_amt);
	});
});
